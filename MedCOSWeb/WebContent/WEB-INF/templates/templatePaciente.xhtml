<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core">
      
  <ui:composition template="/WEB-INF/templates/templateBase.xhtml">
  
    <ui:define name="body">
        <h:form id="formPaciente" class="container">           
            <div class="form-group">
                <h:outputLabel for="nome" value="Nome completo:"/>
                <span class="text-danger"> *</span>
                <h:inputText class="form-control" id="nome" value="#{pacienteControlador.paciente.nome}" required="true" requiredMessage="O nome é obrigatório!" validatorMessage="O nome deve ter entre 5 e 70 caracteres.">
                     <f:validateLength minimum="5" maximum="70"/>
                </h:inputText>
                    
                <small class="form-text text-danger">
                    <h:message for="nome"/>
                </small>
            </div>
            
            <div class='row'>
		        <div class='col-sm'>  
		            <div class="form-group">
		                <h:outputLabel for="cpf" value="CPF:"/>
		                <span class="text-danger"> *</span>
		                <h:inputText class="form-control" id="cpf" value="#{pacienteControlador.paciente.cpf}" required="true" requiredMessage="O CPF é obrigatório!" validatorMessage="O CPF pode ter no máximo 9 dígitos e sem pontuação.">
		                     <f:validateLength minimum="9" maximum="11" />
		                </h:inputText>
		                    
		                <small class="form-text text-danger">
		                    <h:message for="cpf"/>
		                </small>
		            </div>
            	</div>
            	
            	<div class='col-sm'>  
		            <div class="form-group">
		                <h:outputLabel for="dataNascimento" value="Data de Nascimento:"/>
		                <span class="text-danger"> *</span>
		                <h:inputText class="form-control" id="dataNascimento" value="#{pacienteControlador.paciente.dataNascimento}" required="true" requiredMessage="A data de nascimento é obrigatória!" validatorMessage="A data de nascimento deve estar no formato: dia/mês/ano!">
		                     <f:convertDateTime type="date" pattern="dd/MM/yyyy"/>
		                </h:inputText>
		                    
		                <small class="form-text text-danger">
		                    <h:message for="dataNascimento"/>
		                </small>
		            </div>
            	</div>
            </div>
            
            <div class='row'>
		        <div class='col-sm-4'>  
		            <div class="form-group">
		                <h:outputLabel for="estadoCivil" value="Estado Civil:"/>
		                <h:selectOneMenu class="form-control" id="estadoCivil" value="#{pacienteControlador.paciente.estadoCivil}" converterMessage="O estado civil deve ser válido.">
		                    <f:selectItem noSelectionOption="true" itemLabel="--Selecione--"/>
		                    <f:selectItem itemValue="Solteiro(a)" itemLabel="Solteiro(a)"/>
		                    <f:selectItem itemValue="Casado(a)" itemLabel="Casado(a)"/>
		                    <f:selectItem itemValue="Divorciado(a)" itemLabel="Divorciado(a)"/>
		                    <f:selectItem itemValue="Viúvo(a)" itemLabel="Viúvo(a)"/>
		                </h:selectOneMenu>  
		                    
		                <small class="form-text text-danger">
		                    <h:message for="estadoCivil"/>
		                </small>
		            </div>
            	</div>
            	
            	<div class='col-sm-4'>  
		            <div class="form-group">
		                <h:outputLabel for="sexo" value="Sexo:"/>
		                <h:selectOneMenu class="form-control" id="sexo" value="#{pacienteControlador.paciente.sexo}" converterMessage="O sexo deve ser válido.">
		                    <f:selectItem noSelectionOption="true" itemLabel="--Selecione--"/>
		                    <f:selectItem itemValue="Masculino" itemLabel="Masculino"/>
		                    <f:selectItem itemValue="Feminino" itemLabel="Feminino"/>
		                </h:selectOneMenu>  
		                    
		                <small class="form-text text-danger">
		                    <h:message for="sexo"/>
		                </small>
		            </div>
            	</div>
            	
            	<div class='col-sm-4'>  
		            <div class="form-group">
		                <h:outputLabel for="fone" value="Telefone:"/>
		                <h:inputText class="form-control" id="fone" value="#{pacienteControlador.paciente.fone}" validatorMessage="O telefone pode ter no máximo 12 dígitos.">
		                     <f:validateLength minimum="0" maximum="12" />
		                </h:inputText>
		                    
		                <small class="form-text text-danger">
		                    <h:message for="fone"/>
		                </small>
		            </div>
            	</div>
            </div>
            
            <div class='row'>
		        <div class='col-sm-4'>  
		            <div class="form-group">
		                <h:outputLabel for="email" value="Email:"/>
		                <h:inputText class="form-control" id="email" value="#{pacienteControlador.paciente.email}" validatorMessage="O email pode ter no máximo 40 caracteres.">
		                     <f:validateLength minimum="0" maximum="40" />
		                </h:inputText> 
		                    
		                <small class="form-text text-danger">
		                    <h:message for="email"/>
		                </small>
		            </div>
            	</div>
            	
            	<div class='col-sm-4'>  
		            <div class="form-group">
		                <h:outputLabel for="profissao" value="Profissão"/>
		                <h:inputText class="form-control" id="profissao" value="#{pacienteControlador.paciente.profissao}" validatorMessage="O telefone pode ter no máximo 12 dígitos.">
		                     <f:validateLength minimum="0" maximum="25" />
		                </h:inputText>
		                    
		                <small class="form-text text-danger">
		                    <h:message for="profissao"/>
		                </small>
		            </div>
            	</div>
            	
            	<div class='col-sm-4'>  
		            <div class="form-group">
		                <h:outputLabel for="obs" value="Observações:"/>
		                <h:inputText class="form-control" id="obs" value="#{pacienteControlador.paciente.obs}" validatorMessage="As observações podem ter no máximo 30 caracteres.">
		                     <f:validateLength minimum="0" maximum="30" />
		                </h:inputText>
		                    
		                <small class="form-text text-danger">
		                    <h:message for="obs"/>
		                </small>
		            </div>
            	</div>
            </div>
            
            <div class='row'>
		        <div class='col-sm-4'>  
		            <div class="form-group">
		                <h:outputLabel for="logradouro" value="Logradouro:"/>
		                <h:inputText class="form-control" id="logradouro" value="#{pacienteControlador.paciente.endereco.logradouro}" validatorMessage="O logradouro pode ter no máximo 40 caracteres.">
		                     <f:validateLength minimum="0" maximum="40" />
		                </h:inputText> 
		                    
		                <small class="form-text text-danger">
		                    <h:message for="logradouro"/>
		                </small>
		            </div>
            	</div>
            	
            	<div class='col-sm-4'>  
		            <div class="form-group">
		                <h:outputLabel for="numero" value="Número:"/>
		                <h:inputText class="form-control" id="numero" value="#{pacienteControlador.paciente.endereco.numero}" validatorMessage="O número deve estar entre 1 e 10000.">
		                     <f:validateLength minimum="1" maximum="10000" />
		                </h:inputText> 
		                    
		                <small class="form-text text-danger">
		                    <h:message for="numero"/>
		                </small>
		            </div>
            	</div>
            	
            	<div class='col-sm-4'>  
		            <div class="form-group">
		                <h:outputLabel for="bairro" value="Bairro:"/>
		                <h:inputText class="form-control" id="bairro" value="#{pacienteControlador.paciente.endereco.bairro}" validatorMessage="O bairro pode ter no máximo 40 caracteres.">
		                     <f:validateLength minimum="0" maximum="40" />
		                </h:inputText> 
		                    
		                <small class="form-text text-danger">
		                    <h:message for="bairro"/>
		                </small>
		            </div>
            	</div>
            </div>
            
            <div class='row'>
                <div class='col-sm-4'>  
                    <div class="form-group">
                        <h:outputLabel for="cidade" value="Cidade:"/>
                        <h:inputText class="form-control" id="cidade" value="#{pacienteControlador.paciente.endereco.cidade}" validatorMessage="A cidade pode ter no máximo 40 caracteres.">
                             <f:validateLength minimum="0" maximum="40" />
                        </h:inputText> 
                            
                        <small class="form-text text-danger">
                            <h:message for="cidade"/>
                        </small>
                    </div>
                </div>
            
                <div class='col-sm-4'>  
                    <div class="form-group">
                        <h:outputLabel for="estado" value="Estado:"/>
                        <h:selectOneMenu class="form-control" id="estado" value="#{pacienteControlador.paciente.endereco.estado}" converterMessage="O estado deve ser válido.">
                            <f:selectItem noSelectionOption="true" itemLabel="--Selecione--"/>
                            <f:selectItem itemValue="Acre" itemLabel="Acre"/>
                            <f:selectItem itemValue="Alagoas" itemLabel="Alagoas"/>
                            <f:selectItem itemValue="Amapá" itemLabel="Amapá"/>
                            <f:selectItem itemValue="Amapá" itemLabel="Amapá"/>
                            <f:selectItem itemValue="Bahia" itemLabel="Bahia"/>
                            <f:selectItem itemValue="Ceará" itemLabel="Ceará"/>
                            <f:selectItem itemValue="Distrito Federal" itemLabel="Distrito Federal"/>
                            <f:selectItem itemValue="Espírito Santo" itemLabel="Espírito Santo"/>
                            <f:selectItem itemValue="Goiás" itemLabel="Goiás"/>
                            <f:selectItem itemValue="Maranhão" itemLabel="Maranhão"/>
                            <f:selectItem itemValue="Mato Grosso" itemLabel="Mato Grosso"/>
                            <f:selectItem itemValue="Mato Grosso do Sul" itemLabel="Mato Grosso do Sul"/>
                            <f:selectItem itemValue="Pará" itemLabel="Pará"/>
                            <f:selectItem itemValue="Paraíba" itemLabel="Paraíba"/>
                            <f:selectItem itemValue="Paraná" itemLabel="Paraná"/>
                            <f:selectItem itemValue="Pernambuco" itemLabel="Pernambuco"/>
                            <f:selectItem itemValue="Piauí" itemLabel="Piauí"/>
                            <f:selectItem itemValue="Rio de Janeiro" itemLabel="Rio de Janeiro"/>
                            <f:selectItem itemValue="Rio Grande do Norte" itemLabel="Rio Grande do Norte"/>
                            <f:selectItem itemValue="Rio Grande do Sul" itemLabel="Rio Grande do Sul"/>
                            <f:selectItem itemValue="Rondônia" itemLabel="Rondônia"/>
                            <f:selectItem itemValue="Roraima" itemLabel="Roraima"/>
                            <f:selectItem itemValue="Santa Catarina" itemLabel="Santa Catarina"/>
                            <f:selectItem itemValue="São Paulo" itemLabel="São Paulo"/>
                            <f:selectItem itemValue="Sergipe" itemLabel="Sergipe"/>
                            <f:selectItem itemValue="Tocantins" itemLabel="Tocantins"/>
                        </h:selectOneMenu>  
                            
                        <small class="form-text text-danger">
                            <h:message for="estado"/>
                        </small>
                    </div>
                </div>
                
                <div class='col-sm-4'>  
                    <div class="form-group">
                        <h:outputLabel for="cep" value="CEP:"/>
                        <h:inputText class="form-control" id="cep" value="#{pacienteControlador.paciente.endereco.cep}" validatorMessage="O CEP pode ter no máximo 9 dígitos.">
                             <f:validateLength minimum="0" maximum="9" />
                        </h:inputText> 
                            
                        <small class="form-text text-danger">
                            <h:message for="cep"/>
                        </small>
                    </div>
                </div>
            </div>
            
            <h:panelGroup layout="block" id="conteudoDinamico">
	            <div class="row">
	                <div class="col-6">
	                    <div class="form-group">
		                    <div class="card">
		                       <h5 class="card-header">Nova anamnese</h5>
		                       <div class="card-body">
	                                <h:outputLabel for="molde" value="Molde:"/>
	                                <div class="input-group">
	                                    <h:selectOneMenu class="form-control" id="molde" value="#{pacienteControlador.molde}" converter="moldeConversor" converterMessage="O molde deve ser válido.">
		                                    <f:selectItem noSelectionOption="true" itemLabel="--Selecione--"/>
		                                    <f:selectItems value="#{moldeControlador.moldes}" var="molde" itemValue="#{molde}" itemLabel="#{molde.descricao} (#{molde.criacaoString})"/>
		                                </h:selectOneMenu>
	                                    <h:commandLink class="btn btn-success ml-1">
	                                        <f:ajax event="click" render="formPaciente:conteudoDinamico" execute="formPaciente:conteudoDinamico" listener="#{pacienteControlador.novaAnamnese}"/>
	                                        <i class="fas fa-plus"></i>
	                                    </h:commandLink>
	                                </div>
	                                    
	                                <small class="form-text text-danger">
	                                    <h:message for="molde"/>
	                                </small>
	                            </div>
		                     </div>
	                    </div>
	                </div>
	                
	                <div class="col-6">
	                    <div class="form-group">
		                    <div class="card">
		                       <h5 class="card-header">Anamneses existentes</h5>
		                       <div class="card-body">
			                        <h:outputLabel for="anamnese" value="Anamnese:"/>
	                                <div class="input-group">
									    <h:selectOneMenu class="form-control" id="anamnese" value="#{pacienteControlador.anamnese}" converter="anamneseConversor" converterMessage="A anamnese deve ser válida.">
	                                        <f:ajax event="change" render="formPaciente:conteudoDinamico" execute="formPaciente:conteudoDinamico"/>
	                                        <f:selectItem noSelectionOption="true" itemLabel="--Selecione--"/>
	                                        <f:selectItems value="#{pacienteControlador.paciente.anamneses}" var="anamnese" itemValue="#{anamnese}" itemLabel="#{anamnese.molde.descricao} (#{anamnese.dataString})"/>
	                                    </h:selectOneMenu>
									    <h:commandLink class="btn btn-danger ml-1">
									        <f:ajax event="click" render="formPaciente:conteudoDinamico" execute="formPaciente:conteudoDinamico" listener="#{pacienteControlador.excluirAnamnese}"/>
									        <i class="fas fa-trash-alt"></i>
									    </h:commandLink>
									</div>
			                            
			                        <small class="form-text text-danger">
			                            <h:message for="anamnese"/>
			                        </small>
		                       </div>
		                    </div>
	                    </div>
	                </div>
	            </div>
            
            
	            <ui:fragment rendered="#{pacienteControlador.anamnese ne null}">
		            <div class="row">
		                <div class="col-sm">
			               <div class="form-group">
			                   <div class="card">
			                       <h5 class="card-header">Anamnese</h5>
			                       <div class="card-body">
			                            <ui:repeat var="resposta" value="#{pacienteControlador.anamnese.respostas}" varStatus="status">
	                                       <ui:fragment rendered="#{resposta.pergunta.tipo eq 1}">                             
					                           <h:outputLabel for="pergunta#{status.index}" value="#{resposta.pergunta.descricao}"/>
					                           <h:selectOneMenu class="form-control" id="pergunta#{status.index}" value="#{resposta.conteudo}" converterMessage="A resposta deve ser válida.">
					                              <f:selectItem itemValue="Não" itemLabel="Não"/>
					                              <f:selectItem itemValue="Sim" itemLabel="Sim"/>
					                           </h:selectOneMenu>
					                           
					                           <small class="form-text text-danger">
	                                              <h:message for="pergunta#{status.index}"/>
	                                           </small>
				                           </ui:fragment>
				                            
				                            
				                           <ui:fragment rendered="#{resposta.pergunta.tipo eq 2}">                             
	                                           <h:outputLabel for="perguntaX#{status.index}" value="#{resposta.pergunta.descricao}"/>
	                                           <h:inputText class="form-control" id="perguntaX#{status.index}" value="#{resposta.conteudo}" rendered="#{resposta.pergunta.tipo eq 2}" validatorMessage="A resposta pode ter no máximo 40 caracteres.">
		                                           <f:validateLength minimum="3" maximum="40"/>
		                                       </h:inputText>
	                                           
	                                           <small class="form-text text-danger">
	                                              <h:message for="perguntaX#{status.index}"/>
	                                           </small>
	                                       </ui:fragment> 
			                            </ui:repeat>	                            
			                       </div>
		                       </div>
		                    </div>
		                </div>
		            </div>
		        </ui:fragment>
	        </h:panelGroup>
            
            <h:link value="Cancelar" outcome="pacientes" class="btn btn-danger"><i class="fas fa-trash-alt ml-1"></i></h:link>
            <ui:insert name="botaoPrincipal"/>
        </h:form>
        
        <script>
			document.getElementById("itemPacientes").classList.add("active");
		</script>
    </ui:define>
    
  </ui:composition>
</html>